<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Birthday &lt;3</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            overflow-x: hidden;
            background: #FFCAA1;
            min-height: 100vh;
        }

        .page {
            min-height: 100vh;
            display: none;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            position: relative;
            padding: 20px;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
        }

        .page.active {
            display: flex;
            opacity: 1;
        }

        /* PAGE 1 - Letter */
        .pov-text {
            position: absolute;
            top: 50px;
            font-size: 24px;
            color: #e17055;
            font-weight: bold;
            text-align: center;
            width: 90%;
        }

        .envelope-container {
            position: relative;
            margin-top: 100px;
            
        }

        .envelope {
            width: 300px;
            height: 200px;
            position: relative;
            margin: 0 auto;

        }
        
        .envelope::after {
            content: '';
            position: absolute;
            bottom: -180px;
            left: -40px;
            right: -40px;
            height: 180px; /* Increased from 40px to 80px */
            background: #FFCAA1;
            z-index: 4;
        }

        .envelope-back {
            width: 100%;
            height: 100%;
            background: #ddd6c8;
            border: 3px solid #cecac1;
            position: absolute;
            z-index: 1;
        }
            
        .envelope-front {
            width: 100%;
            height: 50%; /* Increase from 50% to 60% */
            background: #ddd6c8;
            border: 3px solid #cecac1;
            position: absolute;
            bottom: 0;
            z-index: 3;
            transform-origin: bottom;
            transition: transform 0.3s ease;
        }

        .envelope-front::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: -5px;
            right: -5px;
            height: 10px;
            background: #ddd6c8;
            z-index: 4;
        }
        

        .envelope-left-mask {
            content: '';
            position: absolute;
            top: 0;
            left: -50px;
            width: 50px;
            height: 100%;
            background: #FFCAA1;
            z-index: 4;
        }

            .envelope-right-mask {
            content: '';
            position: absolute;
            top: 0;
            right: -50px;
            width: 50px;
            height: 100%;
            background: #FFCAA1;
            z-index: 4;
        }


        .envelope-front::before {
            content: '';
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 150px solid transparent;
            border-right: 150px solid transparent;
            border-bottom: 25px solid #ddd6c8;
            border-bottom-color: #ddd6c8;
        }

        .heart-seal {
            position: absolute;
            bottom: 85px;
            left: 50%;
            transform: translateX(-50%);
            width: 30px;
            height: 30px;
            z-index: 4;
        }

        .heart-seal::before {
            content: '❤️';
            font-size: 24px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #e74c3c;
        }

        .letter {
            width: 280px;
            height: 350px;
            background: white;
            border: 2px solid #ccc;
            position: absolute;
            top: 40px;
            left: 50%;
            transform: translateX(-50%) scale(0.7);
            z-index: 1;
            cursor: grab;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transition: transform 0.1s ease;
            font-size: 16px;
            line-height: 1.5;
            color: #333;
            transform-origin: top center;
        }

        .letter:active {
            cursor: grabbing;
        }

        .letter.pulled {
            transform: translateX(-50%) translateY(-100px);
        }

        .pull-instruction {
            text-align: center;
            margin-top: 20px;
            font-size: 18px;
            color: #2d3436;
            font-style: italic;
        }

        .continue-btn {
            background: #b81b1b;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 18px;
            cursor: pointer;
            margin-top: 60px;
            transition: background 0.3s ease;
            z-index: 5;
        }

        .continue-btn:hover {
            background: #b81b1b;
        }

        /* PAGE 2 - Balloons */
        .back-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            background: none;
            border: none;
            border-radius: 0%;
            width: auto;
            height: auto;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 20px;
            color: #333;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .back-btn:hover {
            background: #fff;
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .back-btn.hidden {
            display: none;
        }

        .balloons-page {
            background: white;
            position: relative;
            overflow: hidden;
        }

        .banner {
            position: absolute;
            top: 0;
            width: 100%;
            height: 80px;
            z-index: 1;
        }
        

        .banner::before {
            content: '';
            position: absolute;
            top: 30px;
            left: 0;
            right: 0;
            height: 2px;
            background: black;
            z-index: 0;
            /* Replace the straight line with a curved path */
            background: none;
            border-bottom: 2px solid black;
            border-radius: 0 0 50% 50%;
            height: 30px;
        }

        .banner-flags {
            display: flex;
            justify-content: space-around;
            height: 100%;
            align-items: flex-start;
            position: relative;
        }

        .flag {
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-top: 40px solid;
            position: absolute;
            top: 0;
        }

        /* Position each flag along the arch curve */
        .flag:nth-child(1) { border-top-color: #e74c3c; left: 5%; top: 54px; transform: rotate(7deg); }
        .flag:nth-child(2) { border-top-color: #f39c12; left: 18%; top: 58px; transform: rotate(4deg)}
        .flag:nth-child(3) { border-top-color: #2ecc71; left: 31%; top: 59.5px; transform: rotate(1deg)}
        .flag:nth-child(4) { border-top-color: #3498db; left: 44%; top: 60px; }
        .flag:nth-child(5) { border-top-color: #9b59b6; left: 57%; top: 60px; }
        .flag:nth-child(6) { border-top-color: #e67e22; left: 70%; top: 57.5px; transform: rotate(-1deg)}
        .flag:nth-child(7) { border-top-color: #1abc9c; left: 83%; top: 55px; transform: rotate(-4deg)}
        .flag:nth-child(8) { border-top-color: #e74c3c; left: 96%; top: 48px; transform: rotate(-15deg)}

        .confetti {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #e74c3c;
            animation: confetti-fall 3s linear forwards;
            opacity: 0;
            z-index: 10;
        }

        @keyframes confetti-fall {
            0% {
                transform: translateY(0) translateX(0) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(110vh) translateX(var(--drift, 0px)) rotate(720deg);
                opacity: 0;
            }
        }


        .balloons-container {
            position: relative;
            width: 100%;
            height: 60vh;
            margin-top: 100px;
        }

        .balloon {
            position: absolute;
            width: 80px;
            height: 100px;
            border-radius: 50% 50% 50% 50% / 35% 35% 65% 65%;
            cursor: pointer;
            transition: all 0.5s ease;
            transform: translateY(100vh);
        }
        
        .balloon.float-up {
            animation: float-up 1s ease-out forwards;
        }

        @keyframes float-up {
            0% {
                transform: translateY(100vh);
            }
            100% {
                transform: translateY(0);
            }
        }

        .balloon::before {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 8px;
            height: 8px;
            background: inherit;
            clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
            z-index: 1;
        }

        .balloon::after {
            content: '';
            position: absolute;
            bottom: -60px;
            left: 50%;
            transform: translateX(-50%);
            width: 2px;
            height: 60px;
            background: #333;
            z-index: -1; /* NEW: Push behind the balloon */
        }


        .balloon.animate-up {
            transform: translateY(0);
        }

        .balloon.popped {
            animation: pop 0.3s ease-out forwards;
        }

        @keyframes pop {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.3);
                opacity: 0.7;
            }
            100% {
                transform: scale(0);
                opacity: 0;
            }
        }

        .balloon-text {
            position: absolute;
            background: rgba(255, 255, 255, 0.9);
            padding: 10px;
            border-radius: 10px;
            font-size: 14px;
            color: #333;
            text-align: center;
            opacity: 0;
            transition: opacity 0.3s ease;
            max-width: 150px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .balloon-text.visible {
            opacity: 1;
        }


        /* PAGE 3 - Coupons */
        .coupons-page {
            background: #f8f9fa;
            padding: 20px;
        }

        .coupons-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .coupon {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            padding: 20px;
            color: white;
            position: relative;
            overflow: hidden;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .coupon:hover {
            transform: scale(1.05);
        }

        .coupon::before {
            content: '';
            position: absolute;
            top: 20px;
            right: 20px;
            bottom: 20px;
            width: 80px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .coupon-number {
            position: absolute;
            top: 50%;
            right: 30px;
            transform: translateY(-50%) rotate(90deg);
            font-size: 24px;
            font-weight: bold;
            color: rgba(255,255,255,0.8);
        }

        .coupon-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .coupon-description {
            font-size: 14px;
            margin-bottom: 15px;
            opacity: 0.9;
        }

        .coupon-validity {
            font-size: 12px;
            opacity: 0.7;
        }


        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .envelope {
                width: 250px;
                height: 170px;
            }

            .letter {
                width: 230px;
                height: 300px;
                padding: 15px;
                font-size: 14px;
            }

            .pov-text {
                font-size: 20px;
            }

            .balloon {
                width: 60px;
                height: 80px;
            }

            .coupons-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .coupon {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <button class="back-btn hidden" id="backBtn" onclick="goBack()">←</button>

    <!-- PAGE 1: Letter -->
    <div class="page active" id="page1">
        <!-- CUSTOMIZE: Change the POV text here -->
        <div class="pov-text"></div>
        
        <div class="envelope-container">
            <div class="pull-instruction">Pull out the letter!</div>
            <div class="envelope">
                <div class="envelope-back"></div>
                <div class="envelope-left-mask"></div>
                <div class="envelope-right-mask"></div>
                <div class="letter" id="letter">
                    <!-- CUSTOMIZE: Change the letter content below -->
                    <h3 style="text-align: left; color: #0f0f0f; margin-bottom: 15px;">To: Joya</h3>
                    <p> I wish I could make this day better, 
                        I'm sorry the situation isn't the best. 
                        I miss you more than anything.
                        You’re coming back soon, 
                        and I have so much planned.
                        But in the mean time, I made you this. Happy Birthday albe.
                        You'll also opoen your actual gift when you come home :)
                        </p>
                    
                    <p style="text-align: right; font-style: italic;">Luka &lt;3 </p>
                    <!-- END CUSTOMIZABLE CONTENT -->
                </div>
                <div class="envelope-front"></div>
                <div class="heart-seal"></div>
            </div>
        </div>
        
        <button class="continue-btn" onclick="goToPage(2)">Continue</button>
    </div>

    <!-- PAGE 2: Balloons -->
    <div class="page balloons-page" id="page2">
        <div class="banner">
            <div class="banner-flags">
                <div class="flag"></div>
                <div class="flag"></div>
                <div class="flag"></div>
                <div class="flag"></div>
                <div class="flag"></div>
                <div class="flag"></div>
                <div class="flag"></div>
                <div class="flag"></div>
            </div>
        </div>

        <div class="balloons-container" id="balloonsContainer">
            <!-- Balloons will be dynamically created here -->
        </div>

        <button class="continue-btn" onclick="goToPage(3)" style="position: absolute; bottom: 70px; left: 50%; transform: translateX(-50%); display: none;" id="continueBtn2">Continue</button>
    </div>

    <!-- PAGE 3: Coupons -->
        <div class="page coupons-page" id="page3">
            <h1 style="text-align: center; margin-bottom: 30px; color: #2d3436;">COUPONS</h1>
            
            <div class="coupons-grid" id="couponsGrid">
                <!-- Coupons will be dynamically created here -->
            </div>

            <p style="text-align: center; font-style: italic; color: #636e72; margin: 20px 0; font-size: 16px;">
                You never need a coupon for any of these things anyway
            </p>

            
        </div>

    <script>
        // CUSTOMIZE: Balloon data - change colors, positions, and texts here
        const balloonData = [
            {
                color: '#e74c3c', // Red
                x: '15%',
                y: '20%',
                text: 'You are so stupid I love it'
            },
            {
                color: '#f39c12', // Orange
                x: '35%',
                y: '40%',
                text: 'Your laugh is very cute'
            },
            {
                color: '#2ecc71', // Green
                x: '55%',
                y: '15%',
                text: 'You are so pretty'
            },
            {
                color: '#3498db', // Blue
                x: '75%',
                y: '35%',
                text: 'You are very special'
            },
            {
                color: '#9b59b6', // Purple
                x: '15%',
                y: '55%',
                text: 'You are my star, always'
            },
            {
                color: '#e67e22', // Dark Orange
                x: '60%',
                y: '55%',
                text: 'You have the prettiest eyes ever'
            }
        ];

        // CUSTOMIZE: Coupon data - change titles, descriptions, colors, and validity here
        const couponData = [
            {
                title: 'DINNER',
                description: 'This coupon is for a dinner of <br> your choice, in or out.',
                validity: 'VALID UNTIL: FOREVER',
                number: '001',
                gradient: 'linear-gradient(135deg, #e74c3c 0%, #c0392b 100%)'
            },
            {
                title: 'SHOPPING SPREE',
                description: 'This coupon entitles you to  <br> a shopping spree, my treat :)',
                validity: 'VALID UNTIL: FOREVER',
                number: '002',
                gradient: 'linear-gradient(135deg, #f39c12 0%, #e67e22 100%)'
            },
            {
                title: 'GIFT OF MY CHOICE',
                description: 'This coupon can be used for <br>anthing  you want.',
                validity: 'VALID UNTIL: FOREVER',
                number: '003',
                gradient: 'linear-gradient(135deg, #2ecc71 0%, #27ae60 100%)'
            },
            {
                title: 'SPA DAY',
                description: 'This coupon can be used for a <br> spa day for both of us.',
                validity: 'VALID UNTIL: FOREVER',
                number: '004',
                gradient: 'linear-gradient(135deg, #3498db 0%, #2980b9 100%)'
            },
            {
                title: 'MAKE-OVER',
                description: 'This coupon can be used for<br> you to put makeup on my face. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ',
                validity: 'VALID UNTIL: FOREVER',
                number: '005',
                gradient: 'linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%)'
            },
            {
                title: 'ONE WISH GRANTED',
                description: 'This coupon can be used for<br> anything I  missed in the others.',
                validity: 'VALID UNTIL: FOREVER',
                number: '006',
                gradient: 'linear-gradient(135deg, #e91e63 0%, #ad1457 100%)'
            }
        ];

        let isDragging = false;
        let letterPulled = false;
        let currentPage = 1;

        // Letter dragging functionality
        const letter = document.getElementById('letter');
        let startY = 0;
        let startLetterY = 0;

        letter.addEventListener('mousedown', startDrag);
        letter.addEventListener('touchstart', startDrag);

        function goBack() {
            if (currentPage > 1) {
                goToPage(currentPage - 1);
            }
        }


        function startDrag(e) {
            isDragging = true;
            startY = e.type === 'mousedown' ? e.clientY : e.touches[0].clientY;
            startLetterY = parseInt(getComputedStyle(letter).transform.split(',')[5]) || 0;
            
            document.addEventListener('mousemove', drag);
            document.addEventListener('touchmove', drag);
            document.addEventListener('mouseup', endDrag);
            document.addEventListener('touchend', endDrag);
        }

        function drag(e) {
            if (!isDragging) return;
            
            const currentY = e.type === 'mousemove' ? e.clientY : e.touches[0].clientY;
            const deltaY = currentY - startY;
            const newY = Math.min(startLetterY + deltaY, 0);
            
            // Calculate scale based on how far it's pulled (0.7 to 1.0)
            const pullProgress = Math.min(Math.abs(newY) / 100, 1);
            const scale = 0.7 + (0.3 * pullProgress);
            
            letter.style.transform = `translateX(-50%) translateY(${newY}px) scale(${scale})`;
            
            if (newY < -80 && !letterPulled) {
                letter.classList.add('pulled');
                letterPulled = true;
            }
        }

        function endDrag() {
            isDragging = false;
            document.removeEventListener('mousemove', drag);
            document.removeEventListener('touchmove', drag);
            document.removeEventListener('mouseup', endDrag);
            document.removeEventListener('touchend', endDrag);
        }

        function goToPage(pageNum) {
            const currentPageElement = document.querySelector('.page.active');
            const nextPageElement = document.getElementById(`page${pageNum}`);
            
            // Fade out current page
            currentPageElement.style.opacity = '0';
            
            setTimeout(() => {
                // Hide current page and show next page
                currentPageElement.classList.remove('active');
                nextPageElement.classList.add('active');
                
                // Fade in next page
                setTimeout(() => {
                    nextPageElement.style.opacity = '1';
                }, 50);
                
                currentPage = pageNum;
                
                // Show/hide back button
                const backBtn = document.getElementById('backBtn');
                if (pageNum === 1) {
                    backBtn.classList.add('hidden');
                } else {
                    backBtn.classList.remove('hidden');
                }

                if (pageNum === 2) {
                    initializePage2();
                } else if (pageNum === 3) {
                    initializePage3();
                }
            }, 500); // Wait for fade out to complete
        }

        // Page 2 initialization
        function initializePage2() {
            createConfetti();
            createBalloons();
        }

        function createConfetti() {
    const colors = ['#e74c3c', '#f39c12', '#2ecc71', '#3498db', '#9b59b6', '#e67e22'];
    
    function addConfetti() {
        const confetti = document.createElement('div');
        confetti.className = 'confetti';
        
        // Randomly choose left or right
        const fromLeft = Math.random() > 0.5;
        const xPos = Math.random() * window.innerWidth * 0.25;
        const drift = (Math.random() - 0.5) * 100; // small side drift

        if (fromLeft) {
            confetti.style.left = `${xPos}px`;
            confetti.style.top = '-10px';
        } else {
            confetti.style.right = `${xPos}px`;
            confetti.style.top = '-10px';
        }

        confetti.style.setProperty('--drift', `${drift}px`);
        confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
        confetti.style.animationDuration = (Math.random() * 2 + 3) + 's';

        document.getElementById('page2').appendChild(confetti);

        setTimeout(() => {
            confetti.remove();
        }, 5000);
    }

    // Create confetti continuously
    setInterval(addConfetti, 50);
}


        function createBalloons() {
            const container = document.getElementById('balloonsContainer');
            container.innerHTML = '';
            
            balloonData.forEach((data, index) => {
                setTimeout(() => {
                    const balloon = document.createElement('div');
                    balloon.className = 'balloon';
                    balloon.style.backgroundColor = data.color;
                    balloon.style.left = data.x;
                    balloon.style.top = data.y;
                    balloon.dataset.index = index;
                    
                    const balloonText = document.createElement('div');
                    balloonText.className = 'balloon-text';
                    balloonText.textContent = data.text;
                    balloonText.style.left = data.x;
                    balloonText.style.top = data.y;
                    balloonText.style.transform = 'translate(-50%, -50%)';
                    
                    balloon.addEventListener('click', () => popBalloon(balloon, balloonText, index));
                    
                    container.appendChild(balloon);
                    container.appendChild(balloonText);
                    
                    // Animate balloon up
                    setTimeout(() => {
                        balloon.classList.add('animate-up');
                    }, 100);
                }, index * 500);
            });
        }

        // Add this variable at the top with other variables
        let poppedBalloons = new Set();

        // Replace the existing popBalloon function with this modified version:
        function popBalloon(balloon, balloonText, index) {
            balloon.classList.add('popped');
            balloonText.classList.add('visible');
            
            // Track this balloon as popped
            poppedBalloons.add(index);
            
            // Check if all balloons have been popped at least once
            if (poppedBalloons.size === balloonData.length) {
                document.getElementById('continueBtn2').style.display = 'block';
            }
            
            setTimeout(() => {
                balloon.remove();
                balloonText.classList.remove('visible');
                
                setTimeout(() => {
                    const newBalloon = document.createElement('div');
                    newBalloon.className = 'balloon';
                    newBalloon.style.backgroundColor = balloonData[index].color;
                    newBalloon.style.left = balloonData[index].x;
                    newBalloon.style.top = balloonData[index].y;
                    newBalloon.style.transform = 'translateY(100vh)';
                    
                    newBalloon.addEventListener('click', () => popBalloon(newBalloon, balloonText, index));
                    
                    document.getElementById('balloonsContainer').appendChild(newBalloon);
                    
                    setTimeout(() => {
                        newBalloon.classList.add('float-up');
                    }, 50);
                }, 1000);
            }, 3000);
        }

        // Page 3 initialization
        function initializePage3() {
            const grid = document.getElementById('couponsGrid');
            grid.innerHTML = '';
            
            couponData.forEach((coupon, index) => {
                const couponElement = document.createElement('div');
                couponElement.className = 'coupon';
                couponElement.style.background = coupon.gradient;
                
                couponElement.innerHTML = `
                    <div class="coupon-title">${coupon.title}</div>
                    <div class="coupon-description">${coupon.description}</div>
                    <div class="coupon-validity">${coupon.validity}</div>
                    <div class="coupon-number">${coupon.number}</div>
                `;
                
                grid.appendChild(couponElement);
            });
        }

        // Initialize page 1 on load
        document.addEventListener('DOMContentLoaded', function() {
            // Auto-start confetti and other animations as needed
        });
    </script>
</body>
</html>
